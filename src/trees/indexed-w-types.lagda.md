# Indexed W-types

```agda
module trees.indexed-w-types where
```

<details><summary>Imports</summary>

```agda
open import foundation.universe-levels
```

</details>

## Idea

The concept of _indexed W-types_ is a generalization of ordinary
[W-types](trees.w-types.md) using a dependently typed variant of
[polynomial endofunctors](trees.polynomial-endofunctors.md). The main
idea is that indexed W-types are initial [algebras](trees.algebras-polynomial-endofunctors.md) for the polynomial endofunctor

```text
  (X : I â†’ UU) â†¦ (Î» (j : I) â†’ Î£ (a : A j), Î  (i : I), B i j a â†’ X i),
```

where `B : (i j : I) â†’ A j â†’ ğ’°` is a type family. In other words, given the data

```text
  A : I â†’ ğ’°
  B : (i j : I) â†’ A j â†’ ğ’°
```

of an indexed container we obtain for each `j : I` a multivariable polynomial

```text
  Î£ (a : A j), Î  (i : I), B i j a â†’ X i
```

Since the functorial operation

```text
  (X : I â†’ UU) â†¦ (Î» (j : I) â†’ Î£ (a : A j), Î  (i : I), B i j a â†’ X i),
```

takes an `I`-indexed family of inputs and returns an `I`-indexed family of
outputs, it is endofunctorial, meaning that it can be iterated and we can
consider initial algebras for this endofunctor.

We will formally define the {{#concept "indexed W-type" Agda=indexed-ğ•}} associated to the data of an indexed container as the inductive type generated by

```text
  tree-indexed-ğ• :
    (x : A j) (Î± : (i : I) (y : B i j x) â†’ indexed-ğ• i) â†’ indexed-ğ• j.
```

**Note.** In the usual definition of indexed container, the type family `B` is directly given as a type family over `A`

```text
  B : (i : I) â†’ A i â†’ ğ’°,
```

and furthermore there is a reindexing function

```text
  j : (i : I) (a : A i) â†’ B i a â†’ I.
```

The pair `(B , j)` of such a type family and a reindexing function is via [type duality](foundation.type-duality.md) equivalent to a single type family

```text
  (j i : I) â†’ A i â†’ ğ’°.
```


## Definitions

### The indexed W-type associated to an indexed container.

```agda
data
  indexed-ğ•
    {l1 l2 l3 : Level} (I : UU l1) (A : I â†’ UU l2)
    (B : (i j : I) â†’ A j â†’ UU l3) (j : I) :
    UU (l1 âŠ” l2 âŠ” l3)
    where
  tree-indexed-ğ• :
    (x : A j) (Î± : (i : I) (y : B i j x) â†’ indexed-ğ• I A B i) â†’
    indexed-ğ• I A B j
```
