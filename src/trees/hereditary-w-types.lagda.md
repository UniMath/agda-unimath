# Hereditary W-types

```agda
module trees.hereditary-w-types where
```

<details><summary>Imports</summary>

```agda
open import foundation.action-on-identifications-binary-functions
open import foundation.action-on-identifications-functions
open import foundation.dependent-pair-types
open import foundation.equivalences
open import foundation.function-extensionality
open import foundation.function-types
open import foundation.identity-types
open import foundation.retractions
open import foundation.sections
open import foundation.universe-levels

open import trees.binary-w-types
```

</details>

## Idea

Consider a type `A` and two type families `B` and `C` over `A`. Then we obtain
the [polynomial functor](trees.multivariable-polynomial-functors.md)

```text
  X Y â†¦ Î£ (a : A), (B a â†’ X) Ã— (C a â†’ Y)
```

in two variables `X` and `Y`. By fixing either `X` or `Y`, we obtain two
[polynomial endofunctors](trees.polynomial-endofunctors.md) given by

```text
  Y â†¦ Î£ (a : A), (B a â†’ X) Ã— (C a â†’ Y)
```

and

```text
  X â†¦ Î£ (a : A), (B a â†’ X) Ã— (C a â†’ Y),
```

respectively. The type `left-ğ•` is obtained by letting the left argument vary
and fixing the right argument, i.e., it is the inductive type generated by

```text
  make-left-ğ• : (a : A) â†’ (B a â†’ left-ğ•) â†’ (C a â†’ Y) â†’ left-ğ•.
```

Similarly, the type `right-ğ•` is obtained by fixing the left argument and
varying the right argument, i.e., it is the inductive type generated by

```text
  make-right-ğ• : (a : A) â†’ (B a â†’ X) â†’ (C a â†’ right-ğ•) â†’ right-ğ•.
```

Thus we obtain two operations `left-ğ•` and `right-ğ•`. The left and right
{{#concept "hereditary W-type" Agda=left-hereditary-ğ• Agda=right-hereditary-ğ•}}
are the least fixed points for the operations `left-ğ•` and `right-ğ•`
respectively. That is, we define `left-hereditary-ğ•` as the inductive type
generated by

```text
  make-left-hereditary-ğ• : left-ğ• left-hereditary-ğ• â†’ left-hereditary-ğ•.
```

and we define `right-hereditary-ğ•` as the inductive type generated by

```text
  make-right-hereditary-ğ• : right-ğ• right-hereditary-ğ• â†’ right-hereditary-ğ•.
```

We will construct equivalences

```text
  left-hereditary-ğ• â‰ƒ binary-ğ•
```

and

```text
  right-hereditary-ğ• â‰ƒ binary-ğ•,
```

showing that both the left and right hereditary W-types are equivalent to the
binary W-type associated to `B` and `C`.

### Motivating example

If we choose `A := Fin 2` and

```text
  B 0 := empty        C 0 := empty
  B 1 := unit         C 1 := unit,
```

then the left W-type `left-ğ• B C` is equivalent to the inductive type generated
by

```text
  nil : left-ğ•
  snoc : left-ğ• â†’ Y â†’ left-ğ•,
```

which is equivalent to the type `list` of [lists](lists.lists.md). The left
hereditary W-type `left-hereditary-ğ•` is then equivalent to the type of plane
trees. Furthermore, in this case the binary W-type associated to `B` and `C` is
equivalent to the inductive type generated by

```text
  leaf : left-hereditary-ğ•
  node : left-hereditary-ğ• â†’ left-hereditary-ğ• â†’ left-hereditary-ğ•.
```

Thus we see that the equivalence `left-hereditary-ğ• â‰ƒ binary-ğ•` is a
generalization of the well-known equivalence of plane trees and full binary
plane trees, which is prominent in the study of the
[Catalan numbers](elementary-number-theory.catalan-numbers.md).

## Definitions

### Left hereditary W-types

```agda
module _
  {l1 l2 l3 : Level} {A : UU l1} (B : A â†’ UU l2) (C : A â†’ UU l3)
  where

  data left-ğ• {l4 : Level} (Y : UU l4) : UU (l1 âŠ” l2 âŠ” l3 âŠ” l4) where
    make-left-ğ• : (a : A) â†’ (B a â†’ left-ğ• Y) â†’ (C a â†’ Y) â†’ left-ğ• Y

  data left-hereditary-ğ• : UU (l1 âŠ” l2 âŠ” l3) where
    make-left-hereditary-ğ• : left-ğ• left-hereditary-ğ• â†’ left-hereditary-ğ•
```

### Right hereditary W-types

```agda
module _
  {l1 l2 l3 : Level} {A : UU l1} (B : A â†’ UU l2) (C : A â†’ UU l3)
  where

  data right-ğ• {l4 : Level} (X : UU l4) : UU (l1 âŠ” l2 âŠ” l3 âŠ” l4) where
    make-right-ğ• : (a : A) â†’ (B a â†’ X) â†’ (C a â†’ right-ğ• X) â†’ right-ğ• X

  data right-hereditary-ğ• : UU (l1 âŠ” l2 âŠ” l3) where
    make-right-hereditary-ğ• : right-ğ• right-hereditary-ğ• â†’ right-hereditary-ğ•
```

## Properties

### The left hereditary W-type is a fixed point for `left-ğ•`

```agda
module _
  {l1 l2 l3 : Level} {A : UU l1} (B : A â†’ UU l2) (C : A â†’ UU l3)
  where

  unpack-left-hereditary-ğ• :
    left-hereditary-ğ• B C â†’ left-ğ• B C (left-hereditary-ğ• B C)
  unpack-left-hereditary-ğ• (make-left-hereditary-ğ• T) = T

  is-section-unpack-left-hereditary-ğ• :
    is-section make-left-hereditary-ğ• unpack-left-hereditary-ğ•
  is-section-unpack-left-hereditary-ğ• (make-left-hereditary-ğ• T) = refl

  is-retraction-unpack-left-hereditary-ğ• :
    is-retraction make-left-hereditary-ğ• unpack-left-hereditary-ğ•
  is-retraction-unpack-left-hereditary-ğ• T = refl

  is-equiv-make-left-hereditary-ğ• :
    is-equiv make-left-hereditary-ğ•
  is-equiv-make-left-hereditary-ğ• =
    is-equiv-is-invertible
      ( unpack-left-hereditary-ğ•)
      ( is-section-unpack-left-hereditary-ğ•)
      ( is-retraction-unpack-left-hereditary-ğ•)

  equiv-make-left-hereditary-ğ• :
    left-ğ• B C (left-hereditary-ğ• B C) â‰ƒ left-hereditary-ğ• B C
  pr1 equiv-make-left-hereditary-ğ• = make-left-hereditary-ğ•
  pr2 equiv-make-left-hereditary-ğ• = is-equiv-make-left-hereditary-ğ•
```

### The right hereditary W-type is a fixed point for `right-ğ•`

```agda
module _
  {l1 l2 l3 : Level} {A : UU l1} (B : A â†’ UU l2) (C : A â†’ UU l3)
  where

  unpack-right-hereditary-ğ• :
    right-hereditary-ğ• B C â†’ right-ğ• B C (right-hereditary-ğ• B C)
  unpack-right-hereditary-ğ• (make-right-hereditary-ğ• T) = T

  is-section-unpack-right-hereditary-ğ• :
    is-section make-right-hereditary-ğ• unpack-right-hereditary-ğ•
  is-section-unpack-right-hereditary-ğ• (make-right-hereditary-ğ• T) = refl

  is-retraction-unpack-right-hereditary-ğ• :
    is-retraction make-right-hereditary-ğ• unpack-right-hereditary-ğ•
  is-retraction-unpack-right-hereditary-ğ• T = refl

  is-equiv-make-right-hereditary-ğ• :
    is-equiv make-right-hereditary-ğ•
  is-equiv-make-right-hereditary-ğ• =
    is-equiv-is-invertible
      ( unpack-right-hereditary-ğ•)
      ( is-section-unpack-right-hereditary-ğ•)
      ( is-retraction-unpack-right-hereditary-ğ•)

  equiv-make-right-hereditary-ğ• :
    right-ğ• B C (right-hereditary-ğ• B C) â‰ƒ right-hereditary-ğ• B C
  pr1 equiv-make-right-hereditary-ğ• = make-right-hereditary-ğ•
  pr2 equiv-make-right-hereditary-ğ• = is-equiv-make-right-hereditary-ğ•
```

### Left hereditary W-types are binary W-types

```agda
module _
  {l1 l2 l3 : Level} {A : UU l1} (B : A â†’ UU l2) (C : A â†’ UU l3)
  where

  binary-left-hereditary-ğ• : left-hereditary-ğ• B C â†’ binary-ğ• B C
  binary-left-hereditary-ğ• (make-left-hereditary-ğ• (make-left-ğ• a S T)) =
    make-binary-ğ• a
      ( Î» b â†’ binary-left-hereditary-ğ• (make-left-hereditary-ğ• (S b)))
      ( Î» c â†’ binary-left-hereditary-ğ• (T c))

  left-hereditary-binary-ğ• : binary-ğ• B C â†’ left-hereditary-ğ• B C
  left-hereditary-binary-ğ• (make-binary-ğ• a S T) =
    make-left-hereditary-ğ•
      ( make-left-ğ• a
        ( Î» b â†’
          unpack-left-hereditary-ğ• B C (left-hereditary-binary-ğ• (S b)))
        ( Î» c â†’ left-hereditary-binary-ğ• (T c)))

  is-section-left-hereditary-binary-ğ• :
    is-section binary-left-hereditary-ğ• left-hereditary-binary-ğ•
  is-section-left-hereditary-binary-ğ• (make-binary-ğ• a S T) =
    ap-binary
      ( make-binary-ğ• a)
      ( eq-htpy
        ( Î» b â†’
          ( ap
            ( binary-left-hereditary-ğ•)
            ( is-section-unpack-left-hereditary-ğ• B C
              ( left-hereditary-binary-ğ• (S b)))) âˆ™
          ( is-section-left-hereditary-binary-ğ• (S b))))
      ( eq-htpy (Î» c â†’ is-section-left-hereditary-binary-ğ• (T c)))

  is-retraction-left-hereditary-binary-ğ• :
    is-retraction binary-left-hereditary-ğ• left-hereditary-binary-ğ•
  is-retraction-left-hereditary-binary-ğ•
    ( make-left-hereditary-ğ• (make-left-ğ• a S T)) =
    ap
      ( make-left-hereditary-ğ•)
      ( ap-binary
        ( make-left-ğ• a)
        ( eq-htpy
          ( Î» b â†’
            ap
              ( unpack-left-hereditary-ğ• B C)
              ( is-retraction-left-hereditary-binary-ğ•
                ( make-left-hereditary-ğ• (S b)))))
        ( eq-htpy (Î» c â†’ is-retraction-left-hereditary-binary-ğ• (T c))))

  is-equiv-binary-left-hereditary-ğ• :
    is-equiv binary-left-hereditary-ğ•
  is-equiv-binary-left-hereditary-ğ• =
    is-equiv-is-invertible
      ( left-hereditary-binary-ğ•)
      ( is-section-left-hereditary-binary-ğ•)
      ( is-retraction-left-hereditary-binary-ğ•)

  equiv-binary-left-hereditary-ğ• :
    left-hereditary-ğ• B C â‰ƒ binary-ğ• B C
  pr1 equiv-binary-left-hereditary-ğ• = binary-left-hereditary-ğ•
  pr2 equiv-binary-left-hereditary-ğ• = is-equiv-binary-left-hereditary-ğ•
```

### Right hereditary W-types are binary W-types

```agda
module _
  {l1 l2 l3 : Level} {A : UU l1} (B : A â†’ UU l2) (C : A â†’ UU l3)
  where

  binary-right-hereditary-ğ• : right-hereditary-ğ• B C â†’ binary-ğ• B C
  binary-right-hereditary-ğ• (make-right-hereditary-ğ• (make-right-ğ• a S T)) =
    make-binary-ğ• a
      ( Î» b â†’ binary-right-hereditary-ğ• (S b))
      ( Î» c â†’ binary-right-hereditary-ğ• (make-right-hereditary-ğ• (T c)))

  right-hereditary-binary-ğ• : binary-ğ• B C â†’ right-hereditary-ğ• B C
  right-hereditary-binary-ğ• (make-binary-ğ• a S T) =
    make-right-hereditary-ğ•
      ( make-right-ğ• a
        ( Î» b â†’ right-hereditary-binary-ğ• (S b))
        ( Î» c â†’
          unpack-right-hereditary-ğ• B C (right-hereditary-binary-ğ• (T c))))

  is-section-right-hereditary-binary-ğ• :
    is-section binary-right-hereditary-ğ• right-hereditary-binary-ğ•
  is-section-right-hereditary-binary-ğ• (make-binary-ğ• a S T) =
    ap-binary
      ( make-binary-ğ• a)
      ( eq-htpy (Î» b â†’ is-section-right-hereditary-binary-ğ• (S b)))
      ( eq-htpy
        ( Î» c â†’
          ( ap
            ( binary-right-hereditary-ğ•)
            ( is-section-unpack-right-hereditary-ğ• B C
              ( right-hereditary-binary-ğ• (T c)))) âˆ™
          ( is-section-right-hereditary-binary-ğ• (T c))))

  is-retraction-right-hereditary-binary-ğ• :
    is-retraction binary-right-hereditary-ğ• right-hereditary-binary-ğ•
  is-retraction-right-hereditary-binary-ğ•
    ( make-right-hereditary-ğ• (make-right-ğ• a S T)) =
    ap
      ( make-right-hereditary-ğ•)
      ( ap-binary
        ( make-right-ğ• a)
        ( eq-htpy (Î» b â†’ is-retraction-right-hereditary-binary-ğ• (S b)))
        ( eq-htpy
          ( Î» c â†’
            ap
              ( unpack-right-hereditary-ğ• B C)
              ( is-retraction-right-hereditary-binary-ğ•
                ( make-right-hereditary-ğ• (T c))))))

  is-equiv-binary-right-hereditary-ğ• :
    is-equiv binary-right-hereditary-ğ•
  is-equiv-binary-right-hereditary-ğ• =
    is-equiv-is-invertible
      ( right-hereditary-binary-ğ•)
      ( is-section-right-hereditary-binary-ğ•)
      ( is-retraction-right-hereditary-binary-ğ•)

  equiv-binary-right-hereditary-ğ• :
    right-hereditary-ğ• B C â‰ƒ binary-ğ• B C
  pr1 equiv-binary-right-hereditary-ğ• = binary-right-hereditary-ğ•
  pr2 equiv-binary-right-hereditary-ğ• = is-equiv-binary-right-hereditary-ğ•
```
